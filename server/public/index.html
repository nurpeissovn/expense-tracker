<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FinSet â€“ Finance Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME TOKENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[data-theme="light"] {
  --bg:           #ede9ff;
  --sidebar-bg:   #ffffff;
  --card-bg:      #ffffff;
  --accent:       #7c5cfc;
  --accent-soft:  #ede9ff;
  --accent-hover: #6a4aed;
  --text-1:       #1a1340;
  --text-2:       #9691b0;
  --text-3:       #c4bedd;
  --border:       #ede9ff;
  --row-hover:    #f9f8ff;
  --th-bg:        #f5f3ff;
  --chip-bg:      #f0effe;
  --chip-border:  #e3deff;
  --green-bg:     #dcfce7;
  --green-text:   #15803d;
  --red-bg:       #fee2e2;
  --red-text:     #dc2626;
  --shadow:       0 2px 16px rgba(124,92,252,.08);
  --shadow-card:  0 1px 8px rgba(124,92,252,.06);
  --bar-expense:  #c4b5fd;
  --bar-income:   #7c5cfc;
  --grid-line:    #ede9ff;
  --scroll-thumb: #ddd6fe;
  --modal-overlay:#0f0c1e99;
  --input-bg:     #f9f8ff;
}
[data-theme="dark"] {
  --bg:           #0f0c1e;
  --sidebar-bg:   #17122b;
  --card-bg:      #1e1836;
  --accent:       #7c5cfc;
  --accent-soft:  #2d2250;
  --accent-hover: #9775fa;
  --text-1:       #f0ecff;
  --text-2:       #7b6fa0;
  --text-3:       #453b6b;
  --border:       #2a2244;
  --row-hover:    #221d3a;
  --th-bg:        #1a1530;
  --chip-bg:      #221d3a;
  --chip-border:  #332d52;
  --green-bg:     #052e16;
  --green-text:   #4ade80;
  --red-bg:       #2c0e0e;
  --red-text:     #f87171;
  --shadow:       0 2px 20px rgba(0,0,0,.45);
  --shadow-card:  0 1px 12px rgba(0,0,0,.3);
  --bar-expense:  #4a3880;
  --bar-income:   #7c5cfc;
  --grid-line:    #2a2244;
  --scroll-thumb: #2d2250;
  --modal-overlay:#00000088;
  --input-bg:     #17122b;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET + BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
::-webkit-scrollbar { width:4px; height:4px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:var(--scroll-thumb); border-radius:99px; }
html { font-size:14px; }
body {
  font-family:'Sora',sans-serif;
  background:var(--bg);
  color:var(--text-1);
  min-height:100vh;
  display:flex;
  overflow:hidden;
  transition:background .3s, color .3s;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  width:210px; min-width:210px;
  background:var(--sidebar-bg);
  border-right:1px solid var(--border);
  display:flex; flex-direction:column;
  padding:22px 0 16px;
  height:100vh;
  box-shadow:var(--shadow);
  position:relative; z-index:10;
  transition:width .25s cubic-bezier(.4,0,.2,1), min-width .25s cubic-bezier(.4,0,.2,1), background .3s, border-color .3s;
  overflow:hidden;
}
/* COLLAPSED STATE */
.sidebar.collapsed { width:60px; min-width:60px; }
.sidebar.collapsed .logo span,
.sidebar.collapsed .nav-label,
.sidebar.collapsed .nav-badge-wrap,
.sidebar.collapsed .tog-label,
.sidebar.collapsed .tog { display:none; }
.sidebar.collapsed .logo { padding:0 12px 26px; justify-content:center; }
.sidebar.collapsed .nav-item { justify-content:center; padding:9px 0; }
.sidebar.collapsed .nav-item:hover .nav-tooltip { display:block; }
.sidebar.collapsed .nav-bottom .nav-item { justify-content:center; padding:9px 0; }
.sidebar.collapsed .toggle-row { justify-content:center; }
.sidebar.collapsed .divider { margin:8px 8px; }

.logo {
  display:flex; align-items:center; gap:10px;
  padding:0 18px 26px;
  transition:padding .25s, justify-content .25s;
}
.logo-icon {
  width:34px; height:34px; border-radius:10px;
  background:var(--accent);
  display:flex; align-items:center; justify-content:center; flex-shrink:0;
}
.logo span { font-weight:700; font-size:17px; white-space:nowrap; transition:opacity .2s; }

.nav { flex:1; padding:0 10px; display:flex; flex-direction:column; gap:2px; overflow:hidden; }
.nav-item {
  display:flex; align-items:center; gap:10px;
  padding:9px 12px; border-radius:10px;
  color:var(--text-2); font-size:13.5px; font-weight:500;
  cursor:pointer; transition:all .2s; text-decoration:none; user-select:none;
  position:relative; white-space:nowrap;
}
.nav-item svg { width:16px; height:16px; flex-shrink:0; stroke:currentColor; fill:none; stroke-width:1.8; stroke-linecap:round; stroke-linejoin:round; }
.nav-item:hover { background:var(--accent-soft); color:var(--accent); }
.nav-item.active { background:var(--accent); color:#fff; }
.nav-label { flex:1; }
/* Collapse tooltip */
.nav-tooltip {
  display:none; position:absolute; left:calc(100% + 10px); top:50%; transform:translateY(-50%);
  background:var(--text-1); color:var(--bg); font-size:11.5px; font-weight:600;
  padding:4px 10px; border-radius:7px; white-space:nowrap; z-index:100;
  pointer-events:none;
}
.nav-tooltip::before {
  content:''; position:absolute; right:100%; top:50%; transform:translateY(-50%);
  border:5px solid transparent; border-right-color:var(--text-1);
}
/* Nav badge */
.nav-badge {
  background:#f43f5e; color:#fff;
  font-size:9px; font-weight:700;
  padding:1px 5px; border-radius:99px; min-width:18px; text-align:center;
}
.nav-badge-wrap { display:flex; align-items:center; }

.divider { height:1px; background:var(--border); margin:8px 10px; transition:background .3s; }
.nav-bottom { padding:0 10px; display:flex; flex-direction:column; gap:2px; }
.toggle-row {
  display:flex; align-items:center; gap:10px;
  padding:10px 12px 0;
}
.tog {
  width:42px; height:22px; border-radius:99px;
  background:var(--border); border:none; cursor:pointer; position:relative;
  transition:background .3s; flex-shrink:0; outline:none;
}
[data-theme="dark"] .tog { background:var(--accent); }
.tog::after {
  content:''; position:absolute; top:3px; left:3px;
  width:16px; height:16px; border-radius:50%;
  background:#fff; box-shadow:0 1px 4px rgba(0,0,0,.25);
  transition:transform .3s;
}
[data-theme="dark"] .tog::after { transform:translateX(20px); }
.tog-label { font-size:11.5px; color:var(--text-2); white-space:nowrap; }

/* Collapse button */
.collapse-btn {
  position:absolute; top:24px; right:-12px;
  width:24px; height:24px; border-radius:50%;
  background:var(--card-bg); border:1px solid var(--border);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; z-index:20;
  transition:all .2s, background .3s, border-color .3s;
  box-shadow:var(--shadow-card);
}
.collapse-btn:hover { background:var(--accent-soft); border-color:var(--accent); }
.collapse-btn svg { width:12px; height:12px; stroke:var(--text-2); fill:none; stroke-width:2; stroke-linecap:round; transition:stroke .2s, transform .25s; }
.collapse-btn:hover svg { stroke:var(--accent); }
.sidebar.collapsed .collapse-btn { right:-12px; }
.sidebar.collapsed .collapse-btn svg { transform:rotate(180deg); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main { flex:1; display:flex; flex-direction:column; overflow:auto; height:100vh; }

/* TOPBAR */
.topbar {
  padding:20px 26px 0;
  display:flex; align-items:center; justify-content:space-between; gap:16px;
}
.topbar-left h1 { font-size:22px; font-weight:700; line-height:1.2; }
.topbar-left p  { font-size:12.5px; color:var(--text-2); margin-top:3px; }
.topbar-right   { display:flex; align-items:center; gap:8px; }

.icon-btn {
  width:36px; height:36px; border-radius:10px;
  background:var(--card-bg); border:1px solid var(--border);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:all .2s; position:relative;
}
.icon-btn svg { width:16px; height:16px; stroke:var(--text-2); fill:none; stroke-width:1.8; stroke-linecap:round; stroke-linejoin:round; transition:stroke .3s; }
.icon-btn:hover { background:var(--accent-soft); border-color:var(--accent); }
.icon-btn:hover svg { stroke:var(--accent); }

.n-badge {
  position:absolute; top:-4px; right:-4px;
  width:15px; height:15px; border-radius:50%;
  background:#f43f5e; font-size:8px; font-weight:700; color:#fff;
  display:flex; align-items:center; justify-content:center;
  border:2px solid var(--card-bg); transition:border-color .3s;
}
.user-chip {
  display:flex; align-items:center; gap:8px;
  background:var(--card-bg); border:1px solid var(--border);
  border-radius:12px; padding:5px 12px 5px 5px;
  cursor:pointer; transition:all .2s;
}
.user-chip:hover { border-color:var(--accent); }
.u-av {
  width:28px; height:28px; border-radius:50%;
  background:linear-gradient(135deg,#c4b5fd,#7c5cfc);
  display:flex; align-items:center; justify-content:center;
  color:#fff; font-size:11px; font-weight:700; flex-shrink:0;
}
.u-name  { font-size:12.5px; font-weight:600; line-height:1.2; }
.u-email { font-size:10px; color:var(--text-2); }

/* FILTER BAR (dashboard) */
.filter-bar {
  padding:14px 26px 0;
  display:flex; align-items:center; justify-content:space-between;
}
.filter-l { display:flex; gap:6px; flex-wrap:wrap; }
.filter-r { display:flex; gap:6px; }
.pill {
  display:flex; align-items:center; gap:5px;
  padding:6px 14px; border-radius:99px;
  border:1px solid var(--border); background:var(--card-bg);
  font-size:12.5px; font-weight:500; color:var(--text-2);
  cursor:pointer; transition:all .2s; font-family:'Sora',sans-serif; outline:none;
}
.pill svg { width:13px; height:13px; stroke:currentColor; fill:none; stroke-width:1.8; }
.pill:hover, .pill.active { border-color:var(--accent); color:var(--accent); background:var(--accent-soft); }

.btn-outline {
  display:flex; align-items:center; gap:5px;
  padding:7px 14px; border-radius:10px;
  border:1px solid var(--border); background:var(--card-bg);
  font-size:12.5px; font-weight:500; color:var(--text-2);
  cursor:pointer; transition:all .2s; font-family:'Sora',sans-serif; outline:none;
}
.btn-outline svg { width:14px; height:14px; stroke:currentColor; fill:none; stroke-width:1.8; }
.btn-outline:hover { border-color:var(--accent); color:var(--accent); }

.btn-primary {
  display:flex; align-items:center; gap:5px;
  padding:7px 16px; border-radius:10px;
  border:none; background:var(--accent); color:#fff;
  font-size:12.5px; font-weight:600;
  cursor:pointer; transition:all .2s; font-family:'Sora',sans-serif; outline:none;
}
.btn-primary:hover { background:var(--accent-hover); transform:translateY(-1px); box-shadow:0 4px 14px rgba(124,92,252,.35); }
.btn-danger {
  display:flex; align-items:center; gap:5px;
  padding:7px 16px; border-radius:10px;
  border:none; background:#f43f5e; color:#fff;
  font-size:12.5px; font-weight:600;
  cursor:pointer; transition:all .2s; font-family:'Sora',sans-serif; outline:none;
}
.btn-danger:hover { background:#e11d48; transform:translateY(-1px); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGES (router)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.page { display:none; flex:1; overflow:auto; flex-direction:column; }
.page.active { display:flex; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTENT GRID (dashboard)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.content {
  padding:14px 26px 26px;
  display:grid; grid-template-columns:1fr 270px; gap:14px; flex:1;
}
.col-l { display:flex; flex-direction:column; gap:14px; }
.col-r { display:flex; flex-direction:column; gap:14px; }

/* STAT CARDS */
.stats-row { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; }
.sc {
  background:var(--card-bg); border-radius:16px;
  padding:16px 18px; border:1px solid var(--border);
  box-shadow:var(--shadow-card);
  transition:transform .2s, box-shadow .2s, background .3s, border-color .3s;
}
.sc:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(124,92,252,.12); }
.sc-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
.sc-lbl { font-size:12.5px; font-weight:500; color:var(--text-2); }
.sc-arrow { color:var(--text-3); }
.sc-arrow svg { width:14px; height:14px; stroke:currentColor; fill:none; stroke-width:1.8; transition:stroke .2s; }
.sc:hover .sc-arrow svg { stroke:var(--accent); }
.sc-val {
  font-size:20px; font-weight:700;
  font-family:'DM Mono',monospace; letter-spacing:-.5px;
  margin-bottom:8px; line-height:1;
}
.sc-val .c { font-size:13px; color:var(--text-2); font-weight:400; }
.chg {
  display:inline-flex; align-items:center; gap:3px;
  font-size:11px; font-weight:600;
  padding:3px 7px; border-radius:99px;
}
.chg svg { width:10px; height:10px; stroke:currentColor; fill:none; stroke-width:2.5; }
.chg.up { background:var(--green-bg); color:var(--green-text); }
.chg.dn { background:var(--red-bg);   color:var(--red-text); }
.chg-vs { font-size:11px; color:var(--text-2); margin-left:4px; }

/* GENERIC CARD */
.card {
  background:var(--card-bg); border-radius:16px;
  padding:18px 20px; border:1px solid var(--border);
  box-shadow:var(--shadow-card);
  transition:background .3s, border-color .3s;
}
.card-hd { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
.card-hd h3 { font-size:14.5px; font-weight:700; }
.card-hd .ctl { display:flex; align-items:center; gap:8px; }
.leg { display:flex; gap:12px; }
.leg-i { display:flex; align-items:center; gap:5px; font-size:11.5px; color:var(--text-2); }
.leg-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
.sel {
  border:1px solid var(--border); border-radius:8px;
  padding:4px 8px; font-size:11.5px; color:var(--text-2);
  background:var(--chip-bg); cursor:pointer;
  font-family:'Sora',sans-serif; outline:none; transition:all .2s;
}
.sel:hover { border-color:var(--accent); }

/* CHART */
.chart-wrap { position:relative; padding-left:42px; height:150px; }
.chart-y {
  position:absolute; top:0; left:0; bottom:22px;
  display:flex; flex-direction:column; justify-content:space-between;
  pointer-events:none;
}
.yt { font-size:10px; color:var(--text-2); font-family:'DM Mono',monospace; text-align:right; width:38px; line-height:1; }
.chart-grid {
  position:absolute; top:0; left:42px; right:0; bottom:22px;
  display:flex; flex-direction:column; justify-content:space-between;
  pointer-events:none;
}
.gl { border-top:1px dashed var(--grid-line); transition:border-color .3s; }
.chart-bars {
  position:absolute; top:0; left:42px; right:0; bottom:22px;
  display:flex; align-items:flex-end; gap:8px;
}
.bc { flex:1; display:flex; align-items:flex-end; height:100%; }
.bp { display:flex; align-items:flex-end; gap:4px; width:100%; height:100%; }
.bar {
  flex:1; border-radius:6px 6px 0 0;
  position:relative; cursor:pointer; min-height:4px;
  transition:opacity .2s, filter .2s;
}
.bar:hover { opacity:.82; filter:brightness(1.1); }
.bar.inc { background:var(--bar-income); }
.bar.exp { background:var(--bar-expense); }
.btt {
  position:absolute; bottom:calc(100% + 6px); left:50%; transform:translateX(-50%);
  background:var(--text-1); color:var(--bg);
  font-size:10px; font-weight:600; padding:3px 7px; border-radius:6px;
  white-space:nowrap; display:none; pointer-events:none; z-index:20;
  transition:background .3s, color .3s;
}
.btt::after {
  content:''; position:absolute; top:100%; left:50%; transform:translateX(-50%);
  border:4px solid transparent; border-top-color:var(--text-1); transition:border-color .3s;
}
.bar:hover .btt { display:block; }
.chart-xl {
  position:absolute; bottom:0; left:42px; right:0;
  display:flex; gap:8px;
}
.xl { flex:1; text-align:center; font-size:10px; color:var(--text-2); font-family:'DM Mono',monospace; }

/* TRANSACTIONS TABLE */
.tx-tbl { width:100%; border-collapse:collapse; }
.tx-tbl thead th {
  padding:7px 10px; font-size:10.5px; font-weight:600;
  color:var(--text-2); text-transform:uppercase; letter-spacing:.6px;
  text-align:left; background:var(--th-bg); transition:background .3s;
}
.tx-tbl thead th:first-child { border-radius:8px 0 0 8px; }
.tx-tbl thead th:last-child  { border-radius:0 8px 8px 0; }
.tx-tbl tbody td {
  padding:10px 10px; font-size:12.5px;
  border-bottom:1px solid var(--border); vertical-align:middle;
  transition:background .3s, border-color .3s;
}
.tx-tbl tbody tr:last-child td { border-bottom:none; }
.tx-tbl tbody tr:hover td { background:var(--row-hover); }
.txi {
  width:30px; height:30px; border-radius:8px;
  display:inline-flex; align-items:center; justify-content:center;
  margin-right:8px; vertical-align:middle; flex-shrink:0;
}
.txn { font-weight:500; vertical-align:middle; }
.td-d  { color:var(--text-2); font-size:11.5px; white-space:nowrap; }
.neg   { color:#f43f5e; font-weight:600; font-family:'DM Mono',monospace; white-space:nowrap; }
.pos   { color:#22c55e; font-weight:600; font-family:'DM Mono',monospace; white-space:nowrap; }
.mchip {
  display:inline-flex; align-items:center; gap:4px;
  background:var(--chip-bg); border:1px solid var(--chip-border);
  padding:3px 8px; border-radius:6px;
  font-size:11px; color:var(--text-2); transition:all .3s;
}
.mchip svg { width:11px; height:11px; stroke:currentColor; fill:none; stroke-width:1.8; }
.cchip {
  background:var(--accent-soft); color:var(--accent);
  padding:3px 9px; border-radius:6px; font-size:11px; font-weight:500;
  white-space:nowrap;
}
.cchip.g { background:var(--green-bg); color:var(--green-text); }
.cchip.r { background:var(--red-bg);   color:var(--red-text); }

/* BUDGET / DONUT */
.bgt-wrap { display:flex; gap:14px; align-items:center; }
.donut-c { position:relative; width:106px; height:106px; flex-shrink:0; }
.donut-c svg { width:100%; height:100%; transform:rotate(-90deg); }
.donut-mid {
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  text-align:center; pointer-events:none;
}
.donut-mid .dm-l { font-size:9px; color:var(--text-2); line-height:1.4; }
.donut-mid .dm-v { font-size:13px; font-weight:700; font-family:'DM Mono',monospace; }
.bgt-leg { display:flex; flex-direction:column; gap:6px; flex:1; }
.bli { display:flex; align-items:center; gap:7px; }
.bldot { width:7px; height:7px; border-radius:2px; flex-shrink:0; }
.blname { font-size:11.5px; color:var(--text-2); }

/* SAVING GOALS */
.sg { margin-bottom:13px; }
.sg:last-of-type { margin-bottom:0; }
.sg-top { display:flex; justify-content:space-between; align-items:baseline; margin-bottom:6px; }
.sg-n { font-size:13px; font-weight:600; }
.sg-a { font-size:13px; font-weight:700; font-family:'DM Mono',monospace; color:var(--accent); }
.prog-t { height:6px; background:var(--border); border-radius:99px; overflow:hidden; transition:background .3s; }
.prog-f { height:100%; border-radius:99px; background:var(--accent); transition:width .8s cubic-bezier(.4,0,.2,1); }
.sg-p { font-size:10.5px; color:var(--text-2); margin-top:4px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE WRAPPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.page-header {
  padding:20px 26px 0;
  display:flex; align-items:center; justify-content:space-between; gap:16px;
}
.page-header h1 { font-size:22px; font-weight:700; }
.page-header p  { font-size:12.5px; color:var(--text-2); margin-top:3px; }
.page-body { padding:14px 26px 26px; display:flex; flex-direction:column; gap:14px; flex:1; }

/* TRANSACTIONS PAGE */
.tx-filters {
  display:flex; gap:8px; flex-wrap:wrap; align-items:center;
}
.tx-search {
  flex:1; min-width:180px;
  display:flex; align-items:center; gap:8px;
  background:var(--card-bg); border:1px solid var(--border);
  border-radius:10px; padding:7px 12px;
  transition:border-color .2s;
}
.tx-search:focus-within { border-color:var(--accent); }
.tx-search svg { width:14px; height:14px; stroke:var(--text-2); fill:none; stroke-width:1.8; flex-shrink:0; }
.tx-search input {
  border:none; background:transparent; outline:none;
  font-family:'Sora',sans-serif; font-size:12.5px; color:var(--text-1);
  width:100%;
}
.tx-search input::placeholder { color:var(--text-2); }
.filter-sel {
  border:1px solid var(--border); border-radius:10px;
  padding:7px 10px; font-size:12.5px; color:var(--text-2);
  background:var(--card-bg); cursor:pointer;
  font-family:'Sora',sans-serif; outline:none; transition:all .2s;
}
.filter-sel:hover, .filter-sel:focus { border-color:var(--accent); color:var(--text-1); }
input[type="date"].filter-sel { color:var(--text-1); }

.tx-empty {
  text-align:center; padding:40px 20px;
  color:var(--text-2); font-size:13px;
}
.tx-empty svg { width:40px; height:40px; stroke:var(--text-3); fill:none; stroke-width:1.4; margin-bottom:10px; }

.del-btn {
  background:none; border:none; cursor:pointer; padding:4px;
  color:var(--text-3); transition:color .2s; display:flex; align-items:center;
}
.del-btn:hover { color:#f43f5e; }
.del-btn svg { width:14px; height:14px; stroke:currentColor; fill:none; stroke-width:2; }

/* ANALYTICS PAGE */
.analytics-grid { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
.analytics-wide { grid-column:1/-1; }
.stat-pill {
  background:var(--card-bg); border:1px solid var(--border);
  border-radius:16px; padding:16px 20px;
  box-shadow:var(--shadow-card);
}
.stat-pill h4 { font-size:12px; color:var(--text-2); font-weight:500; margin-bottom:8px; }
.stat-pill .big { font-size:24px; font-weight:700; font-family:'DM Mono',monospace; }
.cat-bars { display:flex; flex-direction:column; gap:10px; margin-top:4px; }
.cat-bar-row { display:flex; align-items:center; gap:10px; }
.cat-bar-label { font-size:12px; color:var(--text-2); width:110px; flex-shrink:0; }
.cat-bar-track { flex:1; height:8px; background:var(--border); border-radius:99px; overflow:hidden; }
.cat-bar-fill { height:100%; border-radius:99px; background:var(--accent); }
.cat-bar-val { font-size:11.5px; font-family:'DM Mono',monospace; color:var(--text-1); width:70px; text-align:right; flex-shrink:0; }

/* WALLET PAGE */
.wallet-cards { display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:14px; margin-bottom:4px; }
.wallet-card {
  border-radius:18px; padding:20px 22px;
  color:#fff; position:relative; overflow:hidden;
  min-height:130px; display:flex; flex-direction:column; justify-content:space-between;
  box-shadow:0 8px 24px rgba(0,0,0,.15);
  cursor:pointer; transition:transform .2s;
}
.wallet-card:hover { transform:translateY(-3px); }
.wc-type { font-size:11px; font-weight:600; opacity:.8; text-transform:uppercase; letter-spacing:.5px; }
.wc-bal { font-size:22px; font-weight:700; font-family:'DM Mono',monospace; margin-top:8px; }
.wc-num { font-size:12px; opacity:.7; letter-spacing:1px; margin-top:4px; }
.wc-shine {
  position:absolute; top:-30px; right:-30px;
  width:100px; height:100px; border-radius:50%;
  background:rgba(255,255,255,.08);
}
.wc-shine2 {
  position:absolute; bottom:-40px; left:-20px;
  width:120px; height:120px; border-radius:50%;
  background:rgba(255,255,255,.05);
}

/* GOALS PAGE */
.goals-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(260px,1fr)); gap:14px; }
.goal-card {
  background:var(--card-bg); border:1px solid var(--border);
  border-radius:16px; padding:18px 20px;
  box-shadow:var(--shadow-card);
}
.goal-icon { font-size:28px; margin-bottom:10px; display:block; }
.goal-name { font-size:14px; font-weight:700; margin-bottom:2px; }
.goal-target { font-size:11.5px; color:var(--text-2); margin-bottom:12px; }
.goal-amount { font-family:'DM Mono',monospace; font-size:13px; font-weight:700; color:var(--accent); }
.goal-pct { font-size:11px; color:var(--text-2); margin-top:4px; }

/* BUDGET PAGE */
.budget-page-grid { display:grid; grid-template-columns:1fr 260px; gap:14px; }
.budget-cat-row {
  display:flex; align-items:center; gap:12px;
  padding:12px 0; border-bottom:1px solid var(--border);
}
.budget-cat-row:last-child { border-bottom:none; }
.budget-cat-dot { width:10px; height:10px; border-radius:3px; flex-shrink:0; }
.budget-cat-name { font-size:13px; font-weight:500; flex:1; }
.budget-cat-bar-wrap { width:120px; height:6px; background:var(--border); border-radius:99px; overflow:hidden; }
.budget-cat-bar { height:100%; border-radius:99px; }
.budget-cat-amt { font-size:12px; font-family:'DM Mono',monospace; color:var(--text-1); width:70px; text-align:right; }

/* SETTINGS PAGE */
.settings-section { margin-bottom:6px; }
.settings-section h4 { font-size:12px; font-weight:600; text-transform:uppercase; letter-spacing:.7px; color:var(--text-2); margin-bottom:10px; }
.settings-row {
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 0; border-bottom:1px solid var(--border);
}
.settings-row:last-child { border-bottom:none; }
.settings-row-left h5 { font-size:13px; font-weight:600; }
.settings-row-left p  { font-size:11.5px; color:var(--text-2); margin-top:2px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  display:none; position:fixed; inset:0;
  background:var(--modal-overlay);
  z-index:1000; align-items:center; justify-content:center;
  backdrop-filter:blur(4px);
}
.modal-overlay.open { display:flex; }
.modal {
  background:var(--card-bg); border-radius:20px;
  padding:28px; width:90%; max-width:480px;
  border:1px solid var(--border);
  box-shadow:0 24px 60px rgba(0,0,0,.2);
  animation:modalIn .25s cubic-bezier(.34,1.56,.64,1) both;
  max-height:90vh; overflow-y:auto;
}
@keyframes modalIn {
  from { opacity:0; transform:scale(.94) translateY(12px); }
  to   { opacity:1; transform:scale(1) translateY(0); }
}
.modal-hd {
  display:flex; align-items:center; justify-content:space-between; margin-bottom:22px;
}
.modal-hd h2 { font-size:17px; font-weight:700; }
.modal-close {
  width:30px; height:30px; border-radius:8px;
  background:var(--chip-bg); border:none; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  transition:all .2s;
}
.modal-close:hover { background:var(--red-bg); }
.modal-close svg { width:14px; height:14px; stroke:var(--text-2); fill:none; stroke-width:2.2; stroke-linecap:round; }
.modal-close:hover svg { stroke:var(--red-text); }

/* Form */
.form-row { margin-bottom:16px; }
.form-row label { display:block; font-size:12px; font-weight:600; color:var(--text-2); margin-bottom:6px; text-transform:uppercase; letter-spacing:.5px; }
.form-input, .form-select, .form-textarea {
  width:100%; padding:10px 14px;
  background:var(--input-bg); border:1px solid var(--border);
  border-radius:10px; font-family:'Sora',sans-serif; font-size:13px; color:var(--text-1);
  outline:none; transition:border-color .2s;
}
.form-input:focus, .form-select:focus, .form-textarea:focus { border-color:var(--accent); }
.form-textarea { resize:vertical; min-height:70px; }
.form-error { font-size:11px; color:var(--red-text); margin-top:4px; display:none; }
.form-error.show { display:block; }
.form-input.err, .form-select.err { border-color:var(--red-text); }
/* type toggle */
.type-toggle { display:flex; gap:8px; }
.type-btn {
  flex:1; padding:9px; border-radius:10px;
  border:2px solid var(--border); background:var(--input-bg);
  font-family:'Sora',sans-serif; font-size:13px; font-weight:600; cursor:pointer;
  transition:all .2s; color:var(--text-2);
}
.type-btn.sel-income  { border-color:var(--green-text); background:var(--green-bg); color:var(--green-text); }
.type-btn.sel-expense { border-color:var(--red-text); background:var(--red-bg); color:var(--red-text); }
.form-actions { display:flex; gap:8px; margin-top:22px; justify-content:flex-end; }

/* TOAST */
.toast {
  position:fixed; bottom:24px; right:24px; z-index:2000;
  background:var(--text-1); color:var(--bg);
  padding:12px 20px; border-radius:12px;
  font-size:13px; font-weight:600;
  box-shadow:0 8px 24px rgba(0,0,0,.2);
  animation:toastIn .3s ease both;
  pointer-events:none;
}
@keyframes toastIn {
  from { opacity:0; transform:translateY(20px); }
  to   { opacity:1; transform:translateY(0); }
}
.toast.out { animation:toastOut .3s ease both; }
@keyframes toastOut {
  to { opacity:0; transform:translateY(20px); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes fadeUp {
  from { opacity:0; transform:translateY(12px); }
  to   { opacity:1; transform:translateY(0); }
}
.anim { animation:fadeUp .4s ease both; }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside class="sidebar" id="sidebar">

  <!-- Collapse button -->
  <button class="collapse-btn" id="collapseBtn" title="Collapse sidebar">
    <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
  </button>

  <!-- Logo -->
  <div class="logo">
    <div class="logo-icon">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="2" y="3" width="20" height="14" rx="3"/><path d="M8 21h8M12 17v4"/>
      </svg>
    </div>
    <span>FinSet</span>
  </div>

  <!-- Main nav -->
  <nav class="nav" id="mainNav">
    <a class="nav-item active" data-page="dashboard">
      <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1.5"/><rect x="14" y="3" width="7" height="7" rx="1.5"/><rect x="3" y="14" width="7" height="7" rx="1.5"/><rect x="14" y="14" width="7" height="7" rx="1.5"/></svg>
      <span class="nav-label">Dashboard</span>
      <span class="nav-tooltip">Dashboard</span>
    </a>
    <a class="nav-item" data-page="transactions">
      <svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
      <span class="nav-label">Transactions</span>
      <span class="nav-badge-wrap"><span class="nav-badge" id="txBadge">0</span></span>
      <span class="nav-tooltip">Transactions</span>
    </a>
    <a class="nav-item" data-page="wallet">
      <svg viewBox="0 0 24 24"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
      <span class="nav-label">Wallet</span>
      <span class="nav-tooltip">Wallet</span>
    </a>
    <a class="nav-item" data-page="goals">
      <svg viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
      <span class="nav-label">Goals</span>
      <span class="nav-badge-wrap"><span class="nav-badge">3</span></span>
      <span class="nav-tooltip">Goals</span>
    </a>
    <a class="nav-item" data-page="budget">
      <svg viewBox="0 0 24 24"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg>
      <span class="nav-label">Budget</span>
      <span class="nav-tooltip">Budget</span>
    </a>
    <a class="nav-item" data-page="analytics">
      <svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
      <span class="nav-label">Analytics</span>
      <span class="nav-tooltip">Analytics</span>
    </a>
    <a class="nav-item" data-page="settings">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 010 14.14M4.93 4.93a10 10 0 000 14.14"/></svg>
      <span class="nav-label">Settings</span>
      <span class="nav-tooltip">Settings</span>
    </a>
  </nav>

  <div class="divider"></div>

  <nav class="nav-bottom">
    <a class="nav-item">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3M12 17h.01"/></svg>
      <span class="nav-label">Help</span>
      <span class="nav-tooltip">Help</span>
    </a>
    <a class="nav-item">
      <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
      <span class="nav-label">Log out</span>
      <span class="nav-tooltip">Log out</span>
    </a>
  </nav>

  <!-- Theme toggle -->
  <div class="toggle-row">
    <button class="tog" id="themeToggle" aria-label="Toggle theme"></button>
    <span class="tog-label" id="themeLabel">Light mode</span>
  </div>
</aside>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="main" id="mainContent">

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DASHBOARD PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page active" data-page="dashboard">
    <!-- Topbar -->
    <div class="topbar">
      <div class="topbar-left">
        <h1>Welcome back, Adaline! ğŸ‘‹</h1>
        <p>It is the best time to manage your finances.</p>
      </div>
      <div class="topbar-right">
        <div class="icon-btn">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        </div>
        <div class="icon-btn" style="position:relative;">
          <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg>
          <span class="n-badge">2</span>
        </div>
        <div class="user-chip">
          <div class="u-av">AL</div>
          <div>
            <div class="u-name">Adaline Lively</div>
            <div class="u-email">adaline@email.com</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter bar -->
    <div class="filter-bar">
      <div class="filter-l">
        <button class="pill active" data-period="month">
          <svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
          This month
        </button>
        <button class="pill" data-period="week">Last 7 days</button>
        <button class="pill" data-period="all">All time</button>
      </div>
      <div class="filter-r">
        <button class="btn-outline" id="manageWidgetsBtn">
          <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          Manage widgets
        </button>
        <button class="btn-primary" id="addTxBtnDash">
          <svg viewBox="0 0 24 24" width="13" height="13" stroke="#fff" fill="none" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          Add transaction
        </button>
      </div>
    </div>

    <!-- Content grid -->
    <div class="content">
      <div class="col-l">
        <!-- Stat cards (data-driven) -->
        <div class="stats-row" id="dashStats"></div>

        <!-- Money flow chart -->
        <div class="card">
          <div class="card-hd">
            <h3>Money flow</h3>
            <div class="ctl">
              <div class="leg">
                <div class="leg-i"><div class="leg-dot" style="background:var(--bar-income)"></div>Income</div>
                <div class="leg-i"><div class="leg-dot" style="background:var(--bar-expense)"></div>Expense</div>
              </div>
            </div>
          </div>
          <div class="chart-wrap">
            <div class="chart-y" id="chartY">
              <span class="yt" id="ytMax"></span>
              <span class="yt" id="ytMid"></span>
              <span class="yt" id="ytLow"></span>
              <span class="yt">$0</span>
            </div>
            <div class="chart-grid">
              <div class="gl"></div><div class="gl"></div><div class="gl"></div><div class="gl"></div>
            </div>
            <div class="chart-bars" id="cBars"></div>
            <div class="chart-xl"  id="cXL"></div>
          </div>
        </div>

        <!-- Recent transactions -->
        <div class="card">
          <div class="card-hd">
            <h3>Recent transactions</h3>
            <div class="ctl">
              <button class="btn-outline" id="seeAllBtn" style="padding:5px 12px;font-size:11.5px;">See all â†’</button>
            </div>
          </div>
          <table class="tx-tbl">
            <thead>
              <tr>
                <th>Date</th><th>Amount</th><th>Description</th><th>Method</th><th>Category</th>
              </tr>
            </thead>
            <tbody id="dashTxBody"></tbody>
          </table>
        </div>
      </div>

      <div class="col-r">
        <!-- Budget -->
        <div class="card">
          <div class="card-hd">
            <h3>Budget</h3>
            <span style="cursor:pointer;color:var(--text-3);"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg></span>
          </div>
          <div class="bgt-wrap">
            <div class="donut-c" id="donutWrap">
              <svg viewBox="0 0 36 36" id="donutSvg">
                <circle cx="18" cy="18" r="14" fill="none" stroke="var(--border)" stroke-width="4.5"/>
              </svg>
              <div class="donut-mid">
                <div class="dm-l">Total<br>this month</div>
                <div class="dm-v" id="donutTotal">$0</div>
              </div>
            </div>
            <div class="bgt-leg" id="donutLegend"></div>
          </div>
        </div>

        <!-- Saving goals -->
        <div class="card">
          <div class="card-hd">
            <h3>Saving goals</h3>
            <button class="btn-outline" onclick="setActivePage('goals')" style="padding:4px 10px;font-size:11px;">View all</button>
          </div>
          <div class="sg">
            <div class="sg-top"><span class="sg-n">ğŸ’» MacBook Pro</span><span class="sg-a">$1,650</span></div>
            <div class="prog-t"><div class="prog-f" data-w="25" style="width:0%"></div></div>
            <div class="sg-p">25% of $6,600</div>
          </div>
          <div class="sg">
            <div class="sg-top"><span class="sg-n">ğŸš— New car</span><span class="sg-a">$60,000</span></div>
            <div class="prog-t"><div class="prog-f" data-w="42" style="width:0%"></div></div>
            <div class="sg-p">42% of $142,857</div>
          </div>
          <div class="sg">
            <div class="sg-top"><span class="sg-n">ğŸ  New house</span><span class="sg-a">$150,000</span></div>
            <div class="prog-t"><div class="prog-f" data-w="3" style="width:0%"></div></div>
            <div class="sg-p">3% of $5,000,000</div>
          </div>
          <button class="btn-primary" style="width:100%;justify-content:center;margin-top:12px;" onclick="setActivePage('goals')">
            <svg viewBox="0 0 24 24" width="13" height="13" stroke="#fff" fill="none" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add saving goal
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TRANSACTIONS PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="transactions">
    <div class="page-header">
      <div>
        <h1>Transactions</h1>
        <p>All your income and expenses in one place.</p>
      </div>
      <button class="btn-primary" id="addTxBtnTx">
        <svg viewBox="0 0 24 24" width="13" height="13" stroke="#fff" fill="none" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Add transaction
      </button>
    </div>
    <div class="page-body">
      <!-- Filters -->
      <div class="tx-filters">
        <div class="tx-search">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
          <input type="text" placeholder="Search by note or categoryâ€¦" id="txSearch">
        </div>
        <select class="filter-sel" id="txTypeFilter">
          <option value="">All types</option>
          <option value="income">Income</option>
          <option value="expense">Expense</option>
        </select>
        <input type="date" class="filter-sel" id="txDateFrom" title="From date">
        <input type="date" class="filter-sel" id="txDateTo"   title="To date">
      </div>
      <!-- Table -->
      <div class="card" style="padding:0;overflow:hidden;">
        <table class="tx-tbl">
          <thead>
            <tr>
              <th style="padding-left:20px;">Date â†“</th>
              <th>Amount</th>
              <th>Description</th>
              <th>Method</th>
              <th>Category</th>
              <th>Type</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="txPageBody"></tbody>
        </table>
        <div id="txEmpty" class="tx-empty" style="display:none;">
          <svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
          <div>No transactions found.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ WALLET PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="wallet">
    <div class="page-header">
      <div><h1>Wallet</h1><p>Your connected accounts and cards.</p></div>
      <button class="btn-primary">
        <svg viewBox="0 0 24 24" width="13" height="13" stroke="#fff" fill="none" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Add account
      </button>
    </div>
    <div class="page-body">
      <div class="wallet-cards">
        <div class="wallet-card" style="background:linear-gradient(135deg,#7c5cfc,#a78bfa);">
          <div class="wc-shine"></div><div class="wc-shine2"></div>
          <div class="wc-type">Main account</div>
          <div class="wc-bal" id="walletMainBal">$0.00</div>
          <div class="wc-num">â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 3254</div>
        </div>
        <div class="wallet-card" style="background:linear-gradient(135deg,#0ea5e9,#38bdf8);">
          <div class="wc-shine"></div><div class="wc-shine2"></div>
          <div class="wc-type">Savings</div>
          <div class="wc-bal">$32,913.00</div>
          <div class="wc-num">â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 2154</div>
        </div>
        <div class="wallet-card" style="background:linear-gradient(135deg,#22c55e,#4ade80);">
          <div class="wc-shine"></div><div class="wc-shine2"></div>
          <div class="wc-type">Crypto</div>
          <div class="wc-bal">$4,210.00</div>
          <div class="wc-num">Ethereum wallet</div>
        </div>
      </div>
      <div class="card">
        <div class="card-hd"><h3>Recent wallet activity</h3></div>
        <table class="tx-tbl"><thead><tr><th>Date</th><th>Amount</th><th>Description</th><th>Method</th><th>Category</th></tr></thead>
        <tbody id="walletTxBody"></tbody></table>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GOALS PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="goals">
    <div class="page-header">
      <div><h1>Saving goals</h1><p>Track your financial milestones.</p></div>
      <button class="btn-primary">
        <svg viewBox="0 0 24 24" width="13" height="13" stroke="#fff" fill="none" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Add goal
      </button>
    </div>
    <div class="page-body">
      <div class="goals-grid">
        <div class="goal-card"><span class="goal-icon">ğŸ’»</span><div class="goal-name">MacBook Pro</div><div class="goal-target">Target: $6,600</div><div class="prog-t"><div class="prog-f" data-w="25" style="width:0%"></div></div><div class="goal-pct">25% â€” <span class="goal-amount">$1,650 saved</span></div></div>
        <div class="goal-card"><span class="goal-icon">ğŸš—</span><div class="goal-name">New car</div><div class="goal-target">Target: $142,857</div><div class="prog-t"><div class="prog-f" data-w="42" style="width:0%"></div></div><div class="goal-pct">42% â€” <span class="goal-amount">$60,000 saved</span></div></div>
        <div class="goal-card"><span class="goal-icon">ğŸ </span><div class="goal-name">New house</div><div class="goal-target">Target: $5,000,000</div><div class="prog-t"><div class="prog-f" data-w="3" style="width:0%"></div></div><div class="goal-pct">3% â€” <span class="goal-amount">$150,000 saved</span></div></div>
        <div class="goal-card" style="display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;border:2px dashed var(--border);background:transparent;min-height:160px;">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--text-3)" stroke-width="1.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          <div style="font-size:13px;color:var(--text-2);margin-top:8px;font-weight:500;">Add new goal</div>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BUDGET PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="budget">
    <div class="page-header">
      <div><h1>Budget</h1><p>Monthly spending by category.</p></div>
    </div>
    <div class="page-body">
      <div class="budget-page-grid">
        <div class="card">
          <div class="card-hd"><h3>Spending by category</h3></div>
          <div id="budgetCatList"></div>
        </div>
        <div class="col-r" style="gap:14px;display:flex;flex-direction:column;">
          <div class="card">
            <div class="card-hd"><h3>Budget overview</h3></div>
            <div class="bgt-wrap">
              <div class="donut-c">
                <svg viewBox="0 0 36 36" id="budgetDonutSvg">
                  <circle cx="18" cy="18" r="14" fill="none" stroke="var(--border)" stroke-width="4.5"/>
                </svg>
                <div class="donut-mid">
                  <div class="dm-l">Total<br>expenses</div>
                  <div class="dm-v" id="budgetDonutTotal">$0</div>
                </div>
              </div>
              <div class="bgt-leg" id="budgetDonutLegend"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ANALYTICS PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="analytics">
    <div class="page-header">
      <div><h1>Analytics</h1><p>Insights into your financial habits.</p></div>
    </div>
    <div class="page-body">
      <div class="analytics-grid">
        <div class="stat-pill anim"><h4>Total income (all time)</h4><div class="big pos" id="anTotalInc">$0</div></div>
        <div class="stat-pill anim"><h4>Total expenses (all time)</h4><div class="big neg" id="anTotalExp">$0</div></div>
        <div class="stat-pill anim"><h4>Net balance</h4><div class="big" id="anNet">$0</div></div>
        <div class="stat-pill anim"><h4>Transactions count</h4><div class="big" id="anCount">0</div></div>
        <div class="card analytics-wide anim">
          <div class="card-hd"><h3>Top expense categories</h3></div>
          <div class="cat-bars" id="anCatBars"></div>
        </div>
        <div class="card analytics-wide anim">
          <div class="card-hd"><h3>Monthly trend (last 6 months)</h3></div>
          <div class="chart-wrap" style="height:160px;">
            <div class="chart-y" id="anChartY">
              <span class="yt" id="anYtMax"></span>
              <span class="yt" id="anYtMid"></span>
              <span class="yt" id="anYtLow"></span>
              <span class="yt">$0</span>
            </div>
            <div class="chart-grid"><div class="gl"></div><div class="gl"></div><div class="gl"></div><div class="gl"></div></div>
            <div class="chart-bars" id="anBars"></div>
            <div class="chart-xl"  id="anXL"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SETTINGS PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <section class="page" data-page="settings">
    <div class="page-header">
      <div><h1>Settings</h1><p>Manage your app preferences and data.</p></div>
    </div>
    <div class="page-body">
      <div class="card" style="max-width:640px;">
        <div class="settings-section">
          <h4>Appearance</h4>
          <div class="settings-row">
            <div class="settings-row-left">
              <h5>Dark mode</h5>
              <p>Switch between light and dark theme</p>
            </div>
            <div style="display:flex;align-items:center;gap:10px;">
              <button class="tog" id="themeToggle2" aria-label="Toggle theme"></button>
              <span class="tog-label" id="themeLabel2">Light mode</span>
            </div>
          </div>
        </div>
        <div class="settings-section" style="margin-top:10px;">
          <h4>Data management</h4>
          <div class="settings-row">
            <div class="settings-row-left">
              <h5>Export transactions</h5>
              <p>Download all your transactions as a JSON file</p>
            </div>
            <button class="btn-outline" id="exportBtn">
              <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" fill="none" stroke-width="1.8"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              Export JSON
            </button>
          </div>
          <div class="settings-row">
            <div class="settings-row-left">
              <h5>Import transactions</h5>
              <p>Upload a previously exported JSON file</p>
            </div>
            <label class="btn-outline" style="cursor:pointer;">
              <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" fill="none" stroke-width="1.8"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              Import JSON
              <input type="file" accept=".json" id="importFile" style="display:none;">
            </label>
          </div>
          <div class="settings-row">
            <div class="settings-row-left">
              <h5>Reset to demo data</h5>
              <p>Clears all data and reloads the demo dataset</p>
            </div>
            <button class="btn-danger" id="resetDemoBtn">
              <svg viewBox="0 0 24 24" width="14" height="14" stroke="#fff" fill="none" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/></svg>
              Reset demo
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

</main><!-- end #mainContent -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADD TRANSACTION MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="txModal">
  <div class="modal">
    <div class="modal-hd">
      <h2>Add transaction</h2>
      <button class="modal-close" id="modalClose">
        <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>

    <!-- Type -->
    <div class="form-row">
      <label>Type</label>
      <div class="type-toggle">
        <button class="type-btn sel-income" id="typeBtnIncome" data-type="income">â†‘ Income</button>
        <button class="type-btn"            id="typeBtnExpense" data-type="expense">â†“ Expense</button>
      </div>
    </div>
    <!-- Amount -->
    <div class="form-row">
      <label>Amount *</label>
      <input class="form-input" type="number" id="fAmount" placeholder="0.00" min="0.01" step="0.01">
      <div class="form-error" id="fAmountErr">Please enter a valid positive amount.</div>
    </div>
    <!-- Category -->
    <div class="form-row">
      <label>Category *</label>
      <select class="form-select" id="fCategory">
        <option value="">Select categoryâ€¦</option>
        <option>Food</option>
        <option>Transport</option>
        <option>Bills</option>
        <option>Shopping</option>
        <option>Health</option>
        <option>Education</option>
        <option>Entertainment</option>
        <option>Salary</option>
        <option>Freelance</option>
        <option>Investment</option>
        <option>Other</option>
      </select>
      <div class="form-error" id="fCategoryErr">Please select a category.</div>
    </div>
    <!-- Custom category -->
    <div class="form-row" id="fCustomCatRow" style="display:none;">
      <label>Custom category</label>
      <input class="form-input" type="text" id="fCustomCat" placeholder="Enter category nameâ€¦">
    </div>
    <!-- Payment method -->
    <div class="form-row">
      <label>Payment method</label>
      <select class="form-select" id="fMethod">
        <option>Cash</option>
        <option>Card</option>
        <option>Transfer</option>
      </select>
    </div>
    <!-- Date -->
    <div class="form-row">
      <label>Date</label>
      <input class="form-input" type="date" id="fDate">
    </div>
    <!-- Note -->
    <div class="form-row">
      <label>Note (optional)</label>
      <textarea class="form-textarea" id="fNote" placeholder="Add a noteâ€¦"></textarea>
    </div>

    <div class="form-actions">
      <button class="btn-outline" id="modalCancelBtn">Cancel</button>
      <button class="btn-primary" id="modalSubmitBtn">Save transaction</button>
    </div>
  </div>
</div>

<!-- TOAST container -->
<div id="toastContainer"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LS_TX      = 'finset_transactions';
const LS_SEEDED  = 'finset_seeded';
const LS_THEME   = 'finset-theme';
const LS_PAGE    = 'finset-page';
const LS_SIDEBAR = 'finset-sidebar';

const CAT_COLORS = {
  'Food':          '#7c5cfc',
  'Transport':     '#9567f8',
  'Bills':         '#a78bfa',
  'Shopping':      '#b08cf6',
  'Health':        '#c9aaf5',
  'Education':     '#dfc8f4',
  'Entertainment': '#38bdf8',
  'Salary':        '#22c55e',
  'Freelance':     '#4ade80',
  'Investment':    '#f59e0b',
  'Other':         '#6b7280',
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEMO SEED DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function getDemoData() {
  const now = new Date();
  const d = (offset, h=10) => {
    const dt = new Date(now);
    dt.setDate(dt.getDate() - offset);
    return dt.toISOString().split('T')[0];
  };
  return [
    { id:uid(), type:'income',  amount:3200, category:'Salary',     method:'Transfer', date:d(1),  note:'Monthly salary' },
    { id:uid(), type:'expense', amount:80,   category:'Food',       method:'Card',     date:d(2),  note:'Yaposhka restaurant' },
    { id:uid(), type:'expense', amount:150,  category:'Shopping',   method:'Card',     date:d(3),  note:'Reserved item' },
    { id:uid(), type:'expense', amount:13,   category:'Entertainment', method:'Card',  date:d(3),  note:'YouTube Premium' },
    { id:uid(), type:'income',  amount:800,  category:'Freelance',  method:'Transfer', date:d(5),  note:'Design project' },
    { id:uid(), type:'expense', amount:120,  category:'Bills',      method:'Transfer', date:d(6),  note:'Electricity' },
    { id:uid(), type:'expense', amount:55,   category:'Transport',  method:'Cash',     date:d(8),  note:'Taxi' },
    { id:uid(), type:'expense', amount:200,  category:'Health',     method:'Card',     date:d(10), note:'Pharmacy' },
    { id:uid(), type:'income',  amount:500,  category:'Investment', method:'Transfer', date:d(12), note:'Dividends' },
    { id:uid(), type:'expense', amount:90,   category:'Food',       method:'Cash',     date:d(14), note:'Groceries' },
    { id:uid(), type:'expense', amount:35,   category:'Education',  method:'Card',     date:d(16), note:'Online course' },
    { id:uid(), type:'income',  amount:1200, category:'Freelance',  method:'Transfer', date:d(20), note:'Web project' },
    { id:uid(), type:'expense', amount:75,   category:'Entertainment', method:'Card',  date:d(22), note:'Netflix + Spotify' },
    { id:uid(), type:'expense', amount:300,  category:'Shopping',   method:'Card',     date:d(25), note:'Clothes' },
    { id:uid(), type:'expense', amount:60,   category:'Transport',  method:'Card',     date:d(28), note:'Fuel' },
  ];
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STORAGE HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function loadTransactions() {
  try { return JSON.parse(localStorage.getItem(LS_TX) || '[]'); } catch { return []; }
}
function saveTransactions(txs) {
  localStorage.setItem(LS_TX, JSON.stringify(txs));
}
function uid() {
  return Date.now().toString(36) + Math.random().toString(36).slice(2,7);
}

/* Seed once */
if (!localStorage.getItem(LS_SEEDED)) {
  saveTransactions(getDemoData());
  localStorage.setItem(LS_SEEDED, '1');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ROUTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PAGES = ['dashboard','transactions','wallet','goals','budget','analytics','settings'];

function setActivePage(page) {
  if (!PAGES.includes(page)) page = 'dashboard';

  // Update sections
  document.querySelectorAll('.page').forEach(p => {
    p.classList.toggle('active', p.dataset.page === page);
  });

  // Update nav
  document.querySelectorAll('[data-page]').forEach(el => {
    if (el.classList.contains('nav-item')) {
      el.classList.toggle('active', el.dataset.page === page);
    }
  });

  // Hash + storage
  history.pushState({page}, '', '#' + page);
  localStorage.setItem(LS_PAGE, page);

  // Render page content
  renderPage(page);

  // Animate progress bars on goals/dashboard
  setTimeout(() => animateProgressBars(), 100);
}

function renderPage(page) {
  switch(page) {
    case 'dashboard':    renderDashboard(); break;
    case 'transactions': renderTransactionsPage(); break;
    case 'analytics':    renderAnalyticsPage(); break;
    case 'budget':       renderBudgetPage(); break;
    case 'wallet':       renderWalletPage(); break;
  }
}

// Hash routing
window.addEventListener('popstate', e => {
  const page = (e.state && e.state.page) || (location.hash.slice(1)) || 'dashboard';
  setActivePage(page);
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let activePeriod = 'month';

function getFilteredTx(period) {
  const all = loadTransactions();
  const now = new Date();
  if (period === 'week') {
    const cutoff = new Date(now); cutoff.setDate(cutoff.getDate() - 7);
    return all.filter(t => new Date(t.date) >= cutoff);
  }
  if (period === 'month') {
    const cutoff = new Date(now); cutoff.setDate(cutoff.getDate() - 30);
    return all.filter(t => new Date(t.date) >= cutoff);
  }
  return all; // all
}

function renderDashboard() {
  const txs = getFilteredTx(activePeriod);
  const income  = txs.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount, 0);
  const expense = txs.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount, 0);
  const balance = income - expense;
  const all = loadTransactions();
  const totalIncome  = all.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount,0);
  const totalExpense = all.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount,0);
  const savings = totalIncome - totalExpense;

  // Stat cards
  const statsEl = document.getElementById('dashStats');
  statsEl.innerHTML = `
    <div class="sc">
      <div class="sc-head"><span class="sc-lbl">Total balance</span><span class="sc-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg></span></div>
      <div class="sc-val">${fmtCurrency(balance)}</div>
      <span class="chg ${balance>=0?'up':'dn'}">
        <svg viewBox="0 0 24 24">${balance>=0?'<polyline points="17 11 12 6 7 11"/><line x1="12" y1="6" x2="12" y2="18"/>':'<polyline points="7 13 12 18 17 13"/><line x1="12" y1="18" x2="12" y2="6"/>'}
        </svg>${balance>=0?'+':''}</span>
      <span class="chg-vs">period net</span>
    </div>
    <div class="sc">
      <div class="sc-head"><span class="sc-lbl">Income</span><span class="sc-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg></span></div>
      <div class="sc-val">${fmtCurrency(income)}</div>
      <span class="chg up"><svg viewBox="0 0 24 24"><polyline points="17 11 12 6 7 11"/><line x1="12" y1="6" x2="12" y2="18"/></svg>+</span>
      <span class="chg-vs">period total</span>
    </div>
    <div class="sc">
      <div class="sc-head"><span class="sc-lbl">Expense</span><span class="sc-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg></span></div>
      <div class="sc-val">${fmtCurrency(expense)}</div>
      <span class="chg dn"><svg viewBox="0 0 24 24"><polyline points="7 13 12 18 17 13"/><line x1="12" y1="18" x2="12" y2="6"/></svg>âˆ’</span>
      <span class="chg-vs">period total</span>
    </div>
    <div class="sc">
      <div class="sc-head"><span class="sc-lbl">Net savings</span><span class="sc-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg></span></div>
      <div class="sc-val">${fmtCurrency(Math.max(0,savings))}</div>
      <span class="chg up"><svg viewBox="0 0 24 24"><polyline points="17 11 12 6 7 11"/><line x1="12" y1="6" x2="12" y2="18"/></svg>all time</span>
      <span class="chg-vs">accumulated</span>
    </div>`;

  // Recent 5 transactions
  const sorted = [...loadTransactions()].sort((a,b)=>new Date(b.date)-new Date(a.date));
  const tbody = document.getElementById('dashTxBody');
  if (sorted.length === 0) {
    tbody.innerHTML = `<tr><td colspan="5" class="tx-empty" style="text-align:center;padding:24px;color:var(--text-2);">No transactions yet. Add one!</td></tr>`;
  } else {
    tbody.innerHTML = sorted.slice(0,5).map(t => txRowHtml(t, false)).join('');
  }

  // Chart
  renderMoneyFlowChart();

  // Donut
  renderDonut('donutSvg','donutTotal','donutLegend', loadTransactions().filter(t=>t.type==='expense'));

  // Wallet balance
  const walletBal = document.getElementById('walletMainBal');
  if (walletBal) walletBal.textContent = fmtCurrency(balance);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MONEY FLOW CHART
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderMoneyFlowChart() {
  const barsEl = document.getElementById('cBars');
  const xlEl   = document.getElementById('cXL');
  if (!barsEl) return;
  barsEl.innerHTML = ''; xlEl.innerHTML = '';

  const all = loadTransactions();
  // Build last 7 months
  const labels = [], incData = [], expData = [];
  const now = new Date();
  for (let i = 6; i >= 0; i--) {
    const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
    const label = d.toLocaleString('en',{month:'short'});
    const y = d.getFullYear(), m = d.getMonth();
    const monthly = all.filter(t => {
      const td = new Date(t.date);
      return td.getFullYear()===y && td.getMonth()===m;
    });
    labels.push(label);
    incData.push(monthly.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount,0));
    expData.push(monthly.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount,0));
  }

  const maxVal = Math.max(...incData, ...expData, 1);
  // Update y labels
  const setYt = (id, val) => { const el=document.getElementById(id); if(el) el.textContent='$'+fmtK(val); };
  setYt('ytMax', maxVal);
  setYt('ytMid', Math.round(maxVal*0.66));
  setYt('ytLow', Math.round(maxVal*0.33));

  labels.forEach((m,i) => {
    const col = document.createElement('div'); col.className='bc';
    const pair = document.createElement('div'); pair.className='bp';
    const ih = Math.max(2,(incData[i]/maxVal)*100);
    const eh = Math.max(2,(expData[i]/maxVal)*100);
    pair.innerHTML = `
      <div class="bar inc" style="height:${ih}%"><div class="btt">${fmtCurrency(incData[i])}</div></div>
      <div class="bar exp" style="height:${eh}%"><div class="btt">${fmtCurrency(expData[i])}</div></div>`;
    col.append(pair); barsEl.append(col);
    const lbl = document.createElement('div'); lbl.className='xl'; lbl.textContent=m;
    xlEl.append(lbl);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DONUT CHART HELPER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderDonut(svgId, totalId, legendId, expenseTxs) {
  const svgEl   = document.getElementById(svgId);
  const totalEl = document.getElementById(totalId);
  const legEl   = document.getElementById(legendId);
  if (!svgEl) return;

  // Group by category
  const catMap = {};
  expenseTxs.forEach(t => {
    catMap[t.category] = (catMap[t.category]||0) + t.amount;
  });
  const total = Object.values(catMap).reduce((s,v)=>s+v,0);
  if (totalEl) totalEl.textContent = fmtCurrency(total);

  // Build SVG circles (donut)
  const cats = Object.entries(catMap).sort((a,b)=>b[1]-a[1]);
  const circumference = 2 * Math.PI * 14; // r=14
  let offset = 0;
  const colorsArr = ['#7c5cfc','#9567f8','#b08cf6','#c9aaf5','#dfc8f4','#efe3f9','#38bdf8','#22c55e'];

  // Keep existing base circle, rebuild segments
  svgEl.innerHTML = `<circle cx="18" cy="18" r="14" fill="none" stroke="var(--border)" stroke-width="4.5"/>`;
  if (legEl) legEl.innerHTML = '';

  if (total === 0) {
    if (legEl) legEl.innerHTML = '<span style="font-size:12px;color:var(--text-2);">No expense data yet.</span>';
    return;
  }

  cats.forEach(([cat, amt], i) => {
    const pct = amt / total;
    const dash = pct * circumference;
    const gap  = circumference - dash;
    const color = CAT_COLORS[cat] || colorsArr[i % colorsArr.length];
    const circle = document.createElementNS('http://www.w3.org/2000/svg','circle');
    circle.setAttribute('cx','18'); circle.setAttribute('cy','18'); circle.setAttribute('r','14');
    circle.setAttribute('fill','none'); circle.setAttribute('stroke',color); circle.setAttribute('stroke-width','4.5');
    circle.setAttribute('stroke-dasharray',`${dash.toFixed(2)} ${gap.toFixed(2)}`);
    circle.setAttribute('stroke-dashoffset', (-offset).toFixed(2));
    svgEl.appendChild(circle);
    offset += dash;

    if (legEl) {
      const row = document.createElement('div'); row.className='bli';
      row.innerHTML = `<div class="bldot" style="background:${color}"></div><span class="blname">${cat}</span>`;
      legEl.appendChild(row);
    }
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TRANSACTIONS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderTransactionsPage() {
  updateTxBadge();
  applyTxFilters();
}

function applyTxFilters() {
  const search  = (document.getElementById('txSearch')?.value||'').toLowerCase();
  const type    = document.getElementById('txTypeFilter')?.value||'';
  const dateFrom= document.getElementById('txDateFrom')?.value||'';
  const dateTo  = document.getElementById('txDateTo')?.value||'';

  let txs = loadTransactions().sort((a,b)=>new Date(b.date)-new Date(a.date));

  if (search)   txs = txs.filter(t=>(t.note||'').toLowerCase().includes(search)||(t.category||'').toLowerCase().includes(search));
  if (type)     txs = txs.filter(t=>t.type===type);
  if (dateFrom) txs = txs.filter(t=>t.date>=dateFrom);
  if (dateTo)   txs = txs.filter(t=>t.date<=dateTo);

  const tbody = document.getElementById('txPageBody');
  const empty = document.getElementById('txEmpty');
  if (!tbody) return;

  if (txs.length === 0) {
    tbody.innerHTML = '';
    if(empty) empty.style.display='block';
  } else {
    if(empty) empty.style.display='none';
    tbody.innerHTML = txs.map(t => txRowHtml(t, true)).join('');
    // Bind delete
    tbody.querySelectorAll('.del-btn').forEach(btn => {
      btn.addEventListener('click', () => deleteTransaction(btn.dataset.id));
    });
  }
}

function txRowHtml(t, showDelete) {
  const isIncome = t.type === 'income';
  const color = CAT_COLORS[t.category] || '#6b7280';
  const iconBg = isIncome ? 'var(--green-bg)' : 'var(--red-bg)';
  const iconStroke = isIncome ? 'var(--green-text)' : 'var(--red-text)';
  const iconSvg = isIncome
    ? `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="${iconStroke}" stroke-width="2.2"><polyline points="17 11 12 6 7 11"/><line x1="12" y1="6" x2="12" y2="18"/></svg>`
    : `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="${iconStroke}" stroke-width="2.2"><polyline points="7 13 12 18 17 13"/><line x1="12" y1="18" x2="12" y2="6"/></svg>`;

  const delBtn = showDelete
    ? `<td><button class="del-btn" data-id="${t.id}" title="Delete">
        <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6M14 11v6"/><path d="M9 6V4h6v2"/></svg>
      </button></td>` : '';

  return `<tr>
    <td class="td-d" style="padding-left:20px;">${fmtDate(t.date)}</td>
    <td class="${isIncome?'pos':'neg'}">${isIncome?'+':'âˆ’'}${fmtCurrency(t.amount)}</td>
    <td><span class="txi" style="background:${iconBg};">${iconSvg}</span><span class="txn">${esc(t.note||t.category)}</span></td>
    <td><span class="mchip"><svg viewBox="0 0 24 24" width="11" height="11" stroke="currentColor" fill="none" stroke-width="1.8"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>${esc(t.method)}</span></td>
    <td><span class="cchip ${isIncome?'g':''}">${esc(t.category)}</span></td>
    ${showDelete ? `<td><span class="cchip ${isIncome?'g':'r'}">${isIncome?'Income':'Expense'}</span></td>` : ''}
    ${delBtn}
  </tr>`;
}

function deleteTransaction(id) {
  if (!confirm('Delete this transaction?')) return;
  const txs = loadTransactions().filter(t => t.id !== id);
  saveTransactions(txs);
  updateTxBadge();
  applyTxFilters();
  renderDashboard();
  showToast('Transaction deleted.');
}

function updateTxBadge() {
  const badge = document.getElementById('txBadge');
  if (badge) badge.textContent = loadTransactions().length;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANALYTICS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderAnalyticsPage() {
  const all = loadTransactions();
  const inc = all.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount,0);
  const exp = all.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount,0);
  const net = inc - exp;

  const setTxt = (id,v) => { const el=document.getElementById(id); if(el) el.textContent=v; };
  setTxt('anTotalInc', fmtCurrency(inc));
  setTxt('anTotalExp', fmtCurrency(exp));
  setTxt('anNet', fmtCurrency(net));
  setTxt('anCount', all.length);

  // Category bars
  const catMap = {};
  all.filter(t=>t.type==='expense').forEach(t=>{ catMap[t.category]=(catMap[t.category]||0)+t.amount; });
  const cats = Object.entries(catMap).sort((a,b)=>b[1]-a[1]).slice(0,6);
  const maxCat = cats[0]?.[1] || 1;
  const catBarsEl = document.getElementById('anCatBars');
  if (catBarsEl) {
    catBarsEl.innerHTML = cats.length ? cats.map(([cat,amt])=>{
      const color = CAT_COLORS[cat]||'#6b7280';
      return `<div class="cat-bar-row">
        <div class="cat-bar-label">${esc(cat)}</div>
        <div class="cat-bar-track"><div class="cat-bar-fill" style="width:${(amt/maxCat*100).toFixed(1)}%;background:${color};"></div></div>
        <div class="cat-bar-val">${fmtCurrency(amt)}</div>
      </div>`;
    }).join('') : '<div style="color:var(--text-2);font-size:13px;">No expense data yet.</div>';
  }

  // Monthly trend chart (last 6 months)
  const anBarsEl = document.getElementById('anBars');
  const anXlEl   = document.getElementById('anXL');
  if (!anBarsEl) return;
  anBarsEl.innerHTML=''; anXlEl.innerHTML='';
  const now = new Date();
  const mLabels=[], mInc=[], mExp=[];
  for(let i=5;i>=0;i--){
    const d=new Date(now.getFullYear(),now.getMonth()-i,1);
    const y=d.getFullYear(),m=d.getMonth();
    mLabels.push(d.toLocaleString('en',{month:'short'}));
    const mo=all.filter(t=>{const td=new Date(t.date);return td.getFullYear()===y&&td.getMonth()===m;});
    mInc.push(mo.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount,0));
    mExp.push(mo.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount,0));
  }
  const mMax=Math.max(...mInc,...mExp,1);
  const anYt=(id,v)=>{const el=document.getElementById(id);if(el)el.textContent='$'+fmtK(v);};
  anYt('anYtMax',mMax);anYt('anYtMid',Math.round(mMax*.66));anYt('anYtLow',Math.round(mMax*.33));
  mLabels.forEach((label,i)=>{
    const col=document.createElement('div');col.className='bc';
    const pair=document.createElement('div');pair.className='bp';
    const ih=Math.max(2,(mInc[i]/mMax)*100);
    const eh=Math.max(2,(mExp[i]/mMax)*100);
    pair.innerHTML=`<div class="bar inc" style="height:${ih}%"><div class="btt">${fmtCurrency(mInc[i])}</div></div><div class="bar exp" style="height:${eh}%"><div class="btt">${fmtCurrency(mExp[i])}</div></div>`;
    col.append(pair);anBarsEl.append(col);
    const lbl=document.createElement('div');lbl.className='xl';lbl.textContent=label;anXlEl.append(lbl);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUDGET PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderBudgetPage() {
  const txs = loadTransactions().filter(t=>t.type==='expense');
  const catMap = {};
  txs.forEach(t=>{ catMap[t.category]=(catMap[t.category]||0)+t.amount; });
  const total = Object.values(catMap).reduce((s,v)=>s+v,0);
  const cats  = Object.entries(catMap).sort((a,b)=>b[1]-a[1]);
  const colorsArr = Object.values(CAT_COLORS);

  const listEl = document.getElementById('budgetCatList');
  if (listEl) {
    listEl.innerHTML = cats.length ? cats.map(([cat,amt],i)=>{
      const color=CAT_COLORS[cat]||colorsArr[i%colorsArr.length];
      const pct=total?(amt/total*100).toFixed(1):0;
      return `<div class="budget-cat-row">
        <div class="budget-cat-dot" style="background:${color}"></div>
        <div class="budget-cat-name">${esc(cat)}</div>
        <div class="budget-cat-bar-wrap"><div class="budget-cat-bar" style="width:${pct}%;background:${color};"></div></div>
        <div class="budget-cat-amt">${fmtCurrency(amt)}</div>
      </div>`;
    }).join('') : '<div style="color:var(--text-2);font-size:13px;padding:12px 0;">No expense data yet.</div>';
  }

  renderDonut('budgetDonutSvg','budgetDonutTotal','budgetDonutLegend', txs);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WALLET PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderWalletPage() {
  const all = loadTransactions();
  const inc = all.filter(t=>t.type==='income').reduce((s,t)=>s+t.amount,0);
  const exp = all.filter(t=>t.type==='expense').reduce((s,t)=>s+t.amount,0);
  const walletBal = document.getElementById('walletMainBal');
  if(walletBal) walletBal.textContent = fmtCurrency(inc-exp);

  const tbody = document.getElementById('walletTxBody');
  if (!tbody) return;
  const sorted = [...all].sort((a,b)=>new Date(b.date)-new Date(a.date));
  tbody.innerHTML = sorted.slice(0,5).map(t=>txRowHtml(t,false)).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let selectedType = 'income';

function openModal() {
  const modal = document.getElementById('txModal');
  // Reset form
  selectedType = 'income';
  document.getElementById('typeBtnIncome').className='type-btn sel-income';
  document.getElementById('typeBtnExpense').className='type-btn';
  document.getElementById('fAmount').value='';
  document.getElementById('fAmount').classList.remove('err');
  document.getElementById('fAmountErr').classList.remove('show');
  document.getElementById('fCategory').value='';
  document.getElementById('fCategory').classList.remove('err');
  document.getElementById('fCategoryErr').classList.remove('show');
  document.getElementById('fCustomCat').value='';
  document.getElementById('fCustomCatRow').style.display='none';
  document.getElementById('fMethod').value='Cash';
  document.getElementById('fDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('fNote').value='';
  modal.classList.add('open');
}

function closeModal() {
  document.getElementById('txModal').classList.remove('open');
}

function submitTransaction() {
  let valid = true;
  const amtRaw = parseFloat(document.getElementById('fAmount').value);
  if (isNaN(amtRaw) || amtRaw <= 0) {
    document.getElementById('fAmount').classList.add('err');
    document.getElementById('fAmountErr').classList.add('show');
    valid = false;
  } else {
    document.getElementById('fAmount').classList.remove('err');
    document.getElementById('fAmountErr').classList.remove('show');
  }

  let cat = document.getElementById('fCategory').value;
  if (!cat) {
    document.getElementById('fCategory').classList.add('err');
    document.getElementById('fCategoryErr').classList.add('show');
    valid = false;
  } else {
    document.getElementById('fCategory').classList.remove('err');
    document.getElementById('fCategoryErr').classList.remove('show');
    if (cat === 'Other') {
      const custom = document.getElementById('fCustomCat').value.trim();
      if (custom) cat = custom;
    }
  }

  if (!valid) return;

  const tx = {
    id:     uid(),
    type:   selectedType,
    amount: amtRaw,
    category: cat,
    method: document.getElementById('fMethod').value,
    date:   document.getElementById('fDate').value,
    note:   document.getElementById('fNote').value.trim(),
  };

  const txs = loadTransactions();
  txs.push(tx);
  saveTransactions(txs);

  closeModal();
  updateTxBadge();
  renderDashboard();
  // If on transactions page, refresh it
  const txPage = document.querySelector('.page[data-page="transactions"]');
  if (txPage && txPage.classList.contains('active')) renderTransactionsPage();

  showToast(`${selectedType==='income'?'Income':'Expense'} of ${fmtCurrency(amtRaw)} saved!`);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showToast(msg, duration=2800) {
  const el = document.createElement('div');
  el.className = 'toast';
  el.textContent = msg;
  document.getElementById('toastContainer').appendChild(el);
  setTimeout(()=>{ el.classList.add('out'); setTimeout(()=>el.remove(), 300); }, duration);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME TOGGLE (shared logic)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function applyTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  const label = theme==='dark' ? 'Dark mode' : 'Light mode';
  const lbl1 = document.getElementById('themeLabel');
  const lbl2 = document.getElementById('themeLabel2');
  if(lbl1) lbl1.textContent = label;
  if(lbl2) lbl2.textContent = label;
  localStorage.setItem(LS_THEME, theme);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS: EXPORT / IMPORT / RESET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function exportData() {
  const data = { transactions: loadTransactions(), exportedAt: new Date().toISOString() };
  const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'finset-transactions.json';
  a.click();
  showToast('Export downloaded!');
}

function importData(file) {
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    try {
      const obj = JSON.parse(e.target.result);
      const txs = obj.transactions || (Array.isArray(obj) ? obj : null);
      if (!txs || !Array.isArray(txs)) throw new Error('Invalid format');
      // Validate each tx
      const valid = txs.every(t => t.id && t.type && t.amount && t.date);
      if (!valid) throw new Error('Invalid transaction structure');
      saveTransactions(txs);
      updateTxBadge();
      renderDashboard();
      showToast(`Imported ${txs.length} transactions!`);
    } catch(err) {
      showToast('Import failed: ' + err.message);
    }
  };
  reader.readAsText(file);
}

function resetDemo() {
  if (!confirm('Reset all data to demo? This will delete your existing transactions.')) return;
  localStorage.removeItem(LS_TX);
  localStorage.removeItem(LS_SEEDED);
  saveTransactions(getDemoData());
  localStorage.setItem(LS_SEEDED,'1');
  updateTxBadge();
  renderDashboard();
  showToast('Demo data loaded!');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR COLLAPSE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setSidebarCollapsed(collapsed) {
  const sidebar = document.getElementById('sidebar');
  sidebar.classList.toggle('collapsed', collapsed);
  localStorage.setItem(LS_SIDEBAR, collapsed ? '1' : '0');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORMAT HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function fmtCurrency(n) {
  return '$' + Math.abs(n).toLocaleString('en',{minimumFractionDigits:2,maximumFractionDigits:2});
}
function fmtK(n) {
  if (n >= 1000) return (n/1000).toFixed(0)+'k';
  return n.toString();
}
function fmtDate(s) {
  if (!s) return '';
  const d = new Date(s+'T12:00:00');
  return d.toLocaleDateString('en',{day:'2-digit',month:'short',year:'numeric'});
}
function esc(s) {
  return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}
function animateProgressBars() {
  document.querySelectorAll('.prog-f[data-w]').forEach(b => {
    const w = b.dataset.w;
    if (b.style.width === '0%' || b.style.width === '') {
      requestAnimationFrame(() => { b.style.width = w + '%'; });
    }
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EVENT LISTENERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded', () => {

  // â”€â”€ SIDEBAR COLLAPSE â”€â”€
  const sidebar = document.getElementById('sidebar');
  const collapseBtn = document.getElementById('collapseBtn');
  const savedCollapse = localStorage.getItem(LS_SIDEBAR);
  if (savedCollapse === '1') sidebar.classList.add('collapsed');

  collapseBtn.addEventListener('click', () => {
    setSidebarCollapsed(!sidebar.classList.contains('collapsed'));
  });

  // â”€â”€ NAV ROUTING â”€â”€
  document.getElementById('mainNav').addEventListener('click', e => {
    const item = e.target.closest('[data-page]');
    if (item) setActivePage(item.dataset.page);
  });

  // â”€â”€ PERIOD PILLS â”€â”€
  document.querySelectorAll('.pill[data-period]').forEach(p => {
    p.addEventListener('click', () => {
      document.querySelectorAll('.pill[data-period]').forEach(x=>x.classList.remove('active'));
      p.classList.add('active');
      activePeriod = p.dataset.period;
      renderDashboard();
    });
  });

  // â”€â”€ ADD TX BUTTONS â”€â”€
  document.getElementById('addTxBtnDash').addEventListener('click', openModal);
  document.getElementById('addTxBtnTx').addEventListener('click', openModal);

  // â”€â”€ SEE ALL â”€â”€
  document.getElementById('seeAllBtn').addEventListener('click', () => setActivePage('transactions'));

  // â”€â”€ MODAL CLOSE â”€â”€
  document.getElementById('modalClose').addEventListener('click', closeModal);
  document.getElementById('modalCancelBtn').addEventListener('click', closeModal);
  document.getElementById('txModal').addEventListener('click', e => {
    if (e.target === document.getElementById('txModal')) closeModal();
  });

  // â”€â”€ MODAL SUBMIT â”€â”€
  document.getElementById('modalSubmitBtn').addEventListener('click', submitTransaction);

  // â”€â”€ TYPE TOGGLE â”€â”€
  document.getElementById('typeBtnIncome').addEventListener('click', () => {
    selectedType='income';
    document.getElementById('typeBtnIncome').className='type-btn sel-income';
    document.getElementById('typeBtnExpense').className='type-btn';
  });
  document.getElementById('typeBtnExpense').addEventListener('click', () => {
    selectedType='expense';
    document.getElementById('typeBtnIncome').className='type-btn';
    document.getElementById('typeBtnExpense').className='type-btn sel-expense';
  });

  // â”€â”€ CUSTOM CATEGORY â”€â”€
  document.getElementById('fCategory').addEventListener('change', e => {
    document.getElementById('fCustomCatRow').style.display = e.target.value==='Other'?'block':'none';
  });

  // â”€â”€ TX FILTERS â”€â”€
  ['txSearch','txTypeFilter','txDateFrom','txDateTo'].forEach(id => {
    document.getElementById(id)?.addEventListener('input', applyTxFilters);
    document.getElementById(id)?.addEventListener('change', applyTxFilters);
  });

  // â”€â”€ THEME TOGGLES (both sidebar and settings) â”€â”€
  function toggleTheme() {
    const next = document.documentElement.getAttribute('data-theme')==='light'?'dark':'light';
    applyTheme(next);
  }
  document.getElementById('themeToggle').addEventListener('click', toggleTheme);
  document.getElementById('themeToggle2').addEventListener('click', toggleTheme);

  // â”€â”€ SETTINGS â”€â”€
  document.getElementById('exportBtn').addEventListener('click', exportData);
  document.getElementById('importFile').addEventListener('change', e => importData(e.target.files[0]));
  document.getElementById('resetDemoBtn').addEventListener('click', resetDemo);

  // â”€â”€ KEYBOARD: ESC closes modal â”€â”€
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') closeModal();
  });

  // â”€â”€ INIT THEME â”€â”€
  const savedTheme = localStorage.getItem(LS_THEME) || 'light';
  applyTheme(savedTheme);

  // â”€â”€ INIT PAGE (hash or localStorage) â”€â”€
  const hashPage = location.hash.slice(1);
  const storedPage = localStorage.getItem(LS_PAGE) || 'dashboard';
  const initPage = PAGES.includes(hashPage) ? hashPage : storedPage;
  setActivePage(initPage);

  // Replace initial history state
  history.replaceState({page:initPage}, '', '#' + initPage);
});
</script>
</body>
</html>
